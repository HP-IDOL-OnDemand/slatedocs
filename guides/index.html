<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Guides</title>

    <link href="../stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="../stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
      <script src="../javascripts/all.js" type="text/javascript"></script>

      <script>
        $(function() {
          setupLanguages(["shell","ruby","python","javascript"]);
        });
      </script>
  </head>

  <body class="guides guides_index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="../images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="ruby">ruby</a>
              <a href="#" data-language-name="python">python</a>
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='http://idolondemand.com'>Sign Up for a Developer Key</a></li>
            <li><a href='http://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<p>Welcome to the IDOL OnDemand Guides.</p>

<p>You will find a list of guides to take you through some of the many functionalitis of IDOL OnDemand.</p>

          <h1 id="machine-learning-prediction">Machine Learning Prediction</h1>

<p>The prediction functionality of IDOL OnDemand lets you train a predictive model to classify untagged information. The training algorithms runs the training data against a set of algorithms and parameters to identify the configuration that fits our dataset the most, alleviating the data scientist&rsquo;s work.</p>

<blockquote>
<p>CSV input format</p>
</blockquote>
<pre><code class="highlight json"><span class="err">sepal_length,sepal_width,petal_length,petal_width,class</span><span class="w">
</span><span class="mf">4.9</span><span class="err">,</span><span class="mi">3</span><span class="err">,</span><span class="mf">1.4</span><span class="err">,</span><span class="mf">0.2</span><span class="err">,Iris_setosa</span><span class="w">
</span><span class="mf">6.9</span><span class="err">,</span><span class="mf">3.1</span><span class="err">,</span><span class="mf">5.4</span><span class="err">,</span><span class="mf">2.1</span><span class="err">,Iris_virginica</span><span class="w">
</span></code></pre>

<blockquote>
<p>JSON input format</p>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
</span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Iris"</span><span class="p">,</span><span class="w">
</span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sepal length"</span><span class="p">,</span><span class="w"> </span><span class="s2">"columnRef"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sepal length"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DOUBLE"</span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sepal width"</span><span class="p">,</span><span class="w"> </span><span class="s2">"columnRef"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sepal width"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DOUBLE"</span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"petal length"</span><span class="p">,</span><span class="w"> </span><span class="s2">"columnRef"</span><span class="p">:</span><span class="w"> </span><span class="s2">"petal length"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DOUBLE"</span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"petal width"</span><span class="p">,</span><span class="w"> </span><span class="s2">"columnRef"</span><span class="p">:</span><span class="w"> </span><span class="s2">"petal width"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DOUBLE"</span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"class"</span><span class="p">,</span><span class="w"> </span><span class="s2">"columnRef"</span><span class="p">:</span><span class="w"> </span><span class="s2">"class"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RICH_TEXT"</span><span class="p">}</span><span class="w">
</span><span class="p">],</span><span class="w">
</span><span class="s2">"values"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="s2">"row"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mf">4.9</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mf">1.4</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="s2">"Iris-setosa"</span><span class="p">]},</span><span class="w">
  </span><span class="p">{</span><span class="s2">"row"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mf">4.4</span><span class="p">,</span><span class="w"> </span><span class="mf">2.9</span><span class="p">,</span><span class="w"> </span><span class="mf">1.4</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="s2">"Iris-setosa"</span><span class="p">]}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="our-dataset">Our dataset</h3>

<p>For this guide, we&rsquo;ll be using a common classfication dataset, the Iris dataset. The dataset contains features of iris plants and links them with the class of iris each feature set belongs to.</p>

<ol>
<li>sepal length in cm</li>
<li>sepal width in cm</li>
<li>petal length in cm</li>
<li>petal width in cm</li>
<li>class: <strong>Predicted Attribute</strong> - Iris Setosa , Iris Versicolour ,Iris Virginica</li>
</ol>

<h2 id="training-our-predictor">Training our predictor</h2>

<blockquote>
<p>Sample call for JSON by URL</p>
</blockquote>

<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="s">"http://api.idolondemand.com/1/api/sync/trainpredictor/v1"</span>
<span class="c">#GET</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"service_name"</span><span class="p">:</span> <span class="s">"irisService"</span><span class="p">,</span> <span class="s">"url"</span><span class="p">:</span> <span class="s">"https://www.idolondemand.com/sample-content/prediction/iris.json"</span><span class="p">,</span> <span class="s">"prediction_field"</span><span class="p">:</span> <span class="s">"class"</span><span class="p">,</span>  <span class="s">"apikey"</span><span class="p">:</span><span class="s">"myapikey"</span> <span class="p">}</span>
<span class="n">bodyobj</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>

<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'httpclient'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="n">clnt</span> <span class="o">=</span> <span class="no">HTTPClient</span><span class="p">.</span><span class="nf">new</span>
<span class="n">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/trainpredictor/v1"</span>
<span class="c1">#GET</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="ss">service_name: </span><span class="s2">"irisService"</span><span class="p">,</span> <span class="ss">url: </span><span class="s2">"https://www.idolondemand.com/sample-content/prediction/iris.json"</span><span class="p">,</span> <span class="ss">prediction_field: </span><span class="s2">"class"</span><span class="p">,</span>  <span class="n">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="n">resp</span><span class="o">=</span><span class="n">clnt</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="n">body</span><span class="o">=</span><span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>

<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">needle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'needle'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/trainpredictor/v1"</span>
<span class="c1">//GET</span>
<span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"service_name"</span><span class="p">:</span> <span class="s2">"irisService"</span><span class="p">,</span> <span class="s2">"url"</span><span class="p">:</span> <span class="s2">"https://www.idolondemand.com/sample-content/prediction/iris.json"</span><span class="p">,</span> <span class="s2">"prediction_field"</span><span class="p">:</span> <span class="s2">"class"</span><span class="p">,</span>  <span class="na">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="nx">needle</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="s1">'get'</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>

<pre><code class="highlight shell">curl -X POST -F <span class="s2">"service_name=irisService"</span>-F <span class="s2">"url=https://www.idolondemand.com/sample-content/prediction/iris.json"</span>-F <span class="s2">"prediction_field=class"</span> -F <span class="s2">"apikey=myapikey"</span>  https://api.idolondemand.com/1/api/sync/createtextindex/v1
</code></pre>

<blockquote>
<p>Sample call for JSON by CSV</p>
</blockquote>

<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="s">"http://api.idolondemand.com/1/api/sync/trainpredictor/v1"</span>
<span class="c">#GET</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"service_name"</span><span class="p">:</span> <span class="s">"irisService"</span><span class="p">,</span> <span class="s">"url"</span><span class="p">:</span> <span class="s">"https://www.idolondemand.com/sample-content/prediction/iris.csv"</span><span class="p">,</span> <span class="s">"prediction_field"</span><span class="p">:</span> <span class="s">"class"</span><span class="p">,</span>  <span class="s">"apikey"</span><span class="p">:</span><span class="s">"myapikey"</span> <span class="p">}</span>
<span class="n">bodyobj</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>

<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'httpclient'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="n">clnt</span> <span class="o">=</span> <span class="no">HTTPClient</span><span class="p">.</span><span class="nf">new</span>
<span class="n">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/trainpredictor/v1"</span>
<span class="c1">#GET</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="ss">service_name: </span><span class="s2">"irisService"</span><span class="p">,</span> <span class="ss">url: </span><span class="s2">"https://www.idolondemand.com/sample-content/prediction/iris.csv"</span><span class="p">,</span> <span class="ss">prediction_field: </span><span class="s2">"class"</span><span class="p">,</span>  <span class="n">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="n">resp</span><span class="o">=</span><span class="n">clnt</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="n">body</span><span class="o">=</span><span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>

<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">needle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'needle'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/trainpredictor/v1"</span>
<span class="c1">//GET</span>
<span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"service_name"</span><span class="p">:</span> <span class="s2">"irisService"</span><span class="p">,</span> <span class="s2">"url"</span><span class="p">:</span> <span class="s2">"https://www.idolondemand.com/sample-content/prediction/iris.csv"</span><span class="p">,</span> <span class="s2">"prediction_field"</span><span class="p">:</span> <span class="s2">"class"</span><span class="p">,</span>  <span class="na">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="nx">needle</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="s1">'get'</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>

<pre><code class="highlight shell">curl -X POST -F <span class="s2">"service_name=irisService"</span>-F <span class="s2">"url=https://www.idolondemand.com/sample-content/prediction/iris.csv"</span>-F <span class="s2">"prediction_field=class"</span> -F <span class="s2">"apikey=myapikey"</span>  https://api.idolondemand.com/1/api/sync/createtextindex/v1
</code></pre>

<p>The <a href="#train-prediction">Train Prediction API</a> is the API that allows the training of the model. It can take two types of input CSV or JSON.</p>

<p>The API also takes a <strong>prediction_field</strong> argument, this is the field/column name that we want to predict.
That field should be present in our training dataset but will be missing or blank when we try to predict it in our next step.</p>

<p>Sample training for the iris dataset is provided at the following links:</p>

<ul>
<li><a href="https://www.idolondemand.com/sample-content/prediction/iris.json">JSON</a></li>
<li><a href="https://www.idolondemand.com/sample-content/prediction/iris.csv">CSV</a></li>
</ul>

<aside class="notice">
If your training dataset has some untagged rows, use the empty_values parameter to let the API know which values not to include in its training. Default is &ldquo;&rdquo; and -1, but you may have &ldquo;Unknown&rdquo; or &ldquo;tbd&rdquo; in your dataset</aside>

<h2 id="predicting-against-it">Predicting against it</h2>

<p>Now that</p>

<p>Once again sample untagged data is provided at the following links:</p>

<ul>
<li><a href="https://www.idolondemand.com/sample-content/prediction/iris.json">JSON</a></li>
<li><a href="https://www.idolondemand.com/sample-content/prediction/iris_nospecies.csv">CSV</a></li>
</ul>

<p>The format is the exact same, however the value in the field with predicting against does not matter as it won&rsquo;t be taken into account.
<aside class="warning">
The API will still expect a column for the field you&rsquo;re predicting, even if it&rsquo;s empty, so make sure it&rsquo;s there!</aside></p>

<p>The <code class="prettyprint">format</code> parameter lets us specify the output, the API can return JSON or CSV.
The Result column will be added containing the prediction field&rsquo;s predicted value.</p>

<blockquote>
<p>Sample call with JSON input returning tagged CSV.</p>
</blockquote>

<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="s">"http://api.idolondemand.com/1/api/sync/trainpredictor/v1"</span>
<span class="c">#GET</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"service_name"</span><span class="p">:</span> <span class="s">"irisService"</span><span class="p">,</span> <span class="s">"url"</span><span class="p">:</span> <span class="s">"https://www.idolondemand.com/sample-content/prediction/iris.json"</span><span class="p">,</span> <span class="s">"prediction_field"</span><span class="p">:</span> <span class="s">"class"</span><span class="p">,</span> <span class="s">"format"</span><span class="p">:</span> <span class="s">"csv"</span><span class="p">,</span>  <span class="s">"apikey"</span><span class="p">:</span><span class="s">"myapikey"</span> <span class="p">}</span>
<span class="n">bodyobj</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>

<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'httpclient'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="n">clnt</span> <span class="o">=</span> <span class="no">HTTPClient</span><span class="p">.</span><span class="nf">new</span>
<span class="n">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/trainpredictor/v1"</span>
<span class="c1">#GET</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="ss">service_name: </span><span class="s2">"irisService"</span><span class="p">,</span> <span class="ss">url: </span><span class="s2">"https://www.idolondemand.com/sample-content/prediction/iris.json"</span><span class="p">,</span> <span class="ss">prediction_field: </span><span class="s2">"class"</span><span class="p">,</span> <span class="ss">format: </span><span class="s2">"csv"</span><span class="p">,</span>  <span class="n">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="n">resp</span><span class="o">=</span><span class="n">clnt</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="n">body</span><span class="o">=</span><span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>

<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">needle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'needle'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/trainpredictor/v1"</span>
<span class="c1">//GET</span>
<span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"service_name"</span><span class="p">:</span> <span class="s2">"irisService"</span><span class="p">,</span> <span class="s2">"url"</span><span class="p">:</span> <span class="s2">"https://www.idolondemand.com/sample-content/prediction/iris.json"</span><span class="p">,</span> <span class="s2">"prediction_field"</span><span class="p">:</span> <span class="s2">"class"</span><span class="p">,</span> <span class="s2">"format"</span><span class="p">:</span> <span class="s2">"csv"</span><span class="p">,</span>  <span class="na">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="nx">needle</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="s1">'get'</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>

<pre><code class="highlight shell">curl -X POST -F <span class="s2">"service_name=irisService"</span>-F <span class="s2">"url=https://www.idolondemand.com/sample-content/prediction/iris.json"</span>-F <span class="s2">"prediction_field=class"</span>-F <span class="s2">"format=csv"</span> -F <span class="s2">"apikey=myapikey"</span>  https://api.idolondemand.com/1/api/sync/createtextindex/v1
</code></pre>

<blockquote>
<p>Sample call with CSV input returning tagged CSV</p>
</blockquote>

<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="s">"http://api.idolondemand.com/1/api/sync/trainpredictor/v1"</span>
<span class="c">#GET</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"service_name"</span><span class="p">:</span> <span class="s">"irisService"</span><span class="p">,</span> <span class="s">"url"</span><span class="p">:</span> <span class="s">"https://www.idolondemand.com/sample-content/prediction/iris_nospecies.csv"</span><span class="p">,</span> <span class="s">"prediction_field"</span><span class="p">:</span> <span class="s">"class"</span><span class="p">,</span> <span class="s">"format"</span><span class="p">:</span> <span class="s">"csv"</span><span class="p">,</span>  <span class="s">"apikey"</span><span class="p">:</span><span class="s">"myapikey"</span> <span class="p">}</span>
<span class="n">bodyobj</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>

<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'httpclient'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="n">clnt</span> <span class="o">=</span> <span class="no">HTTPClient</span><span class="p">.</span><span class="nf">new</span>
<span class="n">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/trainpredictor/v1"</span>
<span class="c1">#GET</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="ss">service_name: </span><span class="s2">"irisService"</span><span class="p">,</span> <span class="ss">url: </span><span class="s2">"https://www.idolondemand.com/sample-content/prediction/iris_nospecies.csv"</span><span class="p">,</span> <span class="ss">prediction_field: </span><span class="s2">"class"</span><span class="p">,</span> <span class="ss">format: </span><span class="s2">"csv"</span><span class="p">,</span>  <span class="n">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="n">resp</span><span class="o">=</span><span class="n">clnt</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="n">body</span><span class="o">=</span><span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>

<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">needle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'needle'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/trainpredictor/v1"</span>
<span class="c1">//GET</span>
<span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"service_name"</span><span class="p">:</span> <span class="s2">"irisService"</span><span class="p">,</span> <span class="s2">"url"</span><span class="p">:</span> <span class="s2">"https://www.idolondemand.com/sample-content/prediction/iris_nospecies.csv"</span><span class="p">,</span> <span class="s2">"prediction_field"</span><span class="p">:</span> <span class="s2">"class"</span><span class="p">,</span> <span class="s2">"format"</span><span class="p">:</span> <span class="s2">"csv"</span><span class="p">,</span>  <span class="na">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="nx">needle</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="s1">'get'</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>

<pre><code class="highlight shell">curl -X POST -F <span class="s2">"service_name=irisService"</span>-F <span class="s2">"url=https://www.idolondemand.com/sample-content/prediction/iris_nospecies.csv"</span>-F <span class="s2">"prediction_field=class"</span>-F <span class="s2">"format=csv"</span> -F <span class="s2">"apikey=myapikey"</span>  https://api.idolondemand.com/1/api/sync/createtextindex/v1
</code></pre>

          <h1 id="text-indexing">Text Indexing</h1>

<p>Text Indexes in IDOL OnDemand allow the indexing of documents, files, tweets or any other form of unstructured text content. Once indexed that content can be searched through utilizing IDOL&rsquo;s powerful conceptual search capabilities; not only can the content be searched it can be organized, categorized, clustered and linked.</p>

<h2 id="create-a-text-index">Create a Text Index</h2>

<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="s">"http://api.idolondemand.com/1/api/sync/createtextindex/v1"</span>
<span class="c">#GET</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"index"</span><span class="p">:</span> <span class="s">"myindex"</span><span class="p">,</span>  <span class="s">"apikey"</span><span class="p">:</span><span class="s">"myapikey"</span> <span class="p">}</span>
<span class="n">bodyobj</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>

<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'httpclient'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="n">clnt</span> <span class="o">=</span> <span class="no">HTTPClient</span><span class="p">.</span><span class="nf">new</span>
<span class="n">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/createtextindex/v1"</span>
<span class="c1">#GET</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="ss">index: </span><span class="s2">"myindex"</span><span class="p">,</span>  <span class="n">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="n">resp</span><span class="o">=</span><span class="n">clnt</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="n">body</span><span class="o">=</span><span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>

<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">needle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'needle'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/createtextindex/v1"</span>
<span class="c1">//GET</span>
<span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"index"</span><span class="p">:</span> <span class="s2">"myindex"</span><span class="p">,</span>  <span class="na">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="nx">needle</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="s1">'get'</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>

<pre><code class="highlight shell">curl -X POST -F <span class="s2">"index=myindex"</span> -F <span class="s2">"apikey=myapikey"</span>  https://api.idolondemand.com/1/api/sync/createtextindex/v1
</code></pre>

<p>Before indexing documents, we must first create a Text Index.</p>

<p>We will need to specify:
* An index name
* An index flavor : flavors are preconfigurations for our indexes, specifying a starting schema and a document limit.</p>

<h2 id="adding-documents-to-an-index">Adding documents to an index</h2>

<blockquote>
<p>Required format for json input</p>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"document"</span><span class="w"> </span><span class="p">:</span><span class="w">
   </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="s2">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"This is my document"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"reference"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"mydoc1"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"myfield"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"a value"</span><span class="p">],</span><span class="w">
         </span><span class="s2">"content"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"A large block of text, which makes up the main body of the document."</span><span class="w">
      </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="s2">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"My Other document"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"reference"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"mydoc2"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"content"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"This document is about something else"</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>After we create an index, we can start populating it with data.
To do so we use the <a href="#">Add to Text Index API</a>.
The Add to Text Index API supports two types of inputs:
* files: IDOL OnDemand will automatically extract content and metadata for over 500 file types and index the data. These files can be provided via url or posted to the api directly
* json: Like a NoSQL database, IDOL OnDemand indexes can index JSON documents.</p>

<h4 id="json-documents">JSON documents</h4>

<p>While the json document format allows any field the following fields are worth noting:</p>

<ul>
<li>title and content : these fields are indexed for conceptual retrieval and relation linking.</li>
<li>reference: automatically generated if not present, consider this the unique id of the documents indexed</li>
</ul>

<aside class="warning">
POST request is recommended to avoid very long query parameters
</aside>

<blockquote>
<p>Adding JSON to a text index</p>
</blockquote>

<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="s">"http://api.idolondemand.com/1/api/sync/addtotextindex/v1"</span>
<span class="c">#POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"json"</span><span class="p">:</span> <span class="s">"{"</span><span class="n">document</span><span class="s">" :[{"</span><span class="n">title</span><span class="s">" : "</span><span class="n">This</span> <span class="ow">is</span> <span class="n">my</span> <span class="n">document</span><span class="s">","</span><span class="n">reference</span><span class="s">" : "</span><span class="n">mydoc1</span><span class="s">","</span><span class="n">myfield</span><span class="s">" : ["</span><span class="n">a</span> <span class="n">value</span><span class="s">"],"</span><span class="n">content</span><span class="s">" : "</span><span class="n">A</span> <span class="n">large</span> <span class="n">block</span> <span class="n">of</span> <span class="n">text</span><span class="p">,</span> <span class="n">which</span> <span class="n">makes</span> <span class="n">up</span> <span class="n">the</span> <span class="n">main</span> <span class="n">body</span> <span class="n">of</span> <span class="n">the</span> <span class="n">document</span><span class="o">.</span><span class="s">"}]}"</span><span class="p">,</span> <span class="s">"index"</span><span class="p">:</span> <span class="s">"myindex"</span><span class="p">,</span>  <span class="s">"apikey"</span><span class="p">:</span><span class="s">"myapikey"</span> <span class="p">}</span>
<span class="n">bodyobj</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>

<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'httpclient'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="n">clnt</span> <span class="o">=</span> <span class="no">HTTPClient</span><span class="p">.</span><span class="nf">new</span>
<span class="n">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/addtotextindex/v1"</span>
<span class="c1">#POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="ss">json: </span><span class="s2">"{"</span><span class="n">document</span><span class="s2">" :[{"</span><span class="n">title</span><span class="s2">" : "</span><span class="no">This</span> <span class="n">is</span> <span class="n">my</span> <span class="n">document</span><span class="s2">","</span><span class="n">reference</span><span class="s2">" : "</span><span class="n">mydoc1</span><span class="s2">","</span><span class="n">myfield</span><span class="s2">" : ["</span><span class="n">a</span> <span class="n">value</span><span class="s2">"],"</span><span class="n">content</span><span class="s2">" : "</span><span class="no">A</span> <span class="n">large</span> <span class="n">block</span> <span class="n">of</span> <span class="n">text</span><span class="p">,</span> <span class="n">which</span> <span class="n">makes</span> <span class="n">up</span> <span class="n">the</span> <span class="n">main</span> <span class="n">body</span> <span class="n">of</span> <span class="n">the</span> <span class="n">document</span><span class="o">.</span><span class="s2">"}]}"</span><span class="p">,</span> <span class="ss">index: </span><span class="s2">"myindex"</span><span class="p">,</span>  <span class="n">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="n">resp</span><span class="o">=</span><span class="n">clnt</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="n">body</span><span class="o">=</span><span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>

<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">needle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'needle'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/addtotextindex/v1"</span>
<span class="c1">//POST</span>
<span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"json"</span><span class="p">:</span> <span class="s2">"{"</span><span class="nb">document</span><span class="s2">" :[{"</span><span class="nx">title</span><span class="s2">" : "</span><span class="nx">This</span> <span class="nx">is</span> <span class="nx">my</span> <span class="nb">document</span><span class="s2">","</span><span class="nx">reference</span><span class="s2">" : "</span><span class="nx">mydoc1</span><span class="s2">","</span><span class="nx">myfield</span><span class="s2">" : ["</span><span class="nx">a</span> <span class="nx">value</span><span class="s2">"],"</span><span class="nx">content</span><span class="s2">" : "</span><span class="nx">A</span> <span class="nx">large</span> <span class="nx">block</span> <span class="nx">of</span> <span class="nx">text</span><span class="p">,</span> <span class="nx">which</span> <span class="nx">makes</span> <span class="nx">up</span> <span class="nx">the</span> <span class="nx">main</span> <span class="nx">body</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nb">document</span><span class="p">.</span><span class="s2">"}]}"</span><span class="p">,</span> <span class="s2">"index"</span><span class="p">:</span> <span class="s2">"myindex"</span><span class="p">,</span>  <span class="na">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="nx">needle</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>

<pre><code class="highlight shell">curl -X POST -F <span class="s2">"json={"</span>document<span class="s2">" :[{"</span>title<span class="s2">" : "</span>This is my document<span class="s2">","</span>reference<span class="s2">" : "</span>mydoc1<span class="s2">","</span>myfield<span class="s2">" : ["</span>a value<span class="s2">"],"</span>content<span class="s2">" : "</span>A large block of text, which makes up the main body of the document.<span class="s2">"}]}"</span>-F <span class="s2">"index=myindex"</span> -F <span class="s2">"apikey=myapikey"</span>  https://api.idolondemand.com/1/api/sync/createtextindex/v1
</code></pre>

<h3 id="files">Files</h3>

<p>The API will extract text and metadata from files</p>

<blockquote>
<p>Adding Files to an index</p>
</blockquote>

<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="s">"http://api.idolondemand.com/1/api/sync/addtotextindex/v1"</span>
<span class="c">#FILE POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"index"</span><span class="p">:</span> <span class="s">"myindex"</span><span class="p">,</span>  <span class="s">"apikey"</span><span class="p">:</span><span class="s">"myapikey"</span> <span class="p">}</span>
<span class="n">files</span><span class="o">=</span><span class="p">{</span><span class="s">"file"</span><span class="p">:</span><span class="nb">open</span><span class="p">(</span><span class="s">"/home/user/testdata/sample.doc"</span><span class="p">,</span><span class="s">"rb"</span><span class="p">)}</span>
<span class="n">bodyobj</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>

<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'httpclient'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="n">clnt</span> <span class="o">=</span> <span class="no">HTTPClient</span><span class="p">.</span><span class="nf">new</span>
<span class="n">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/addtotextindex/v1"</span>
<span class="c1">#FILE POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"file"</span><span class="p">:</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"/home/user/testdata/sample.doc"</span><span class="p">),</span><span class="ss">index: </span><span class="s2">"myindex"</span><span class="p">,</span>  <span class="s2">"apikey"</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="n">resp</span><span class="o">=</span><span class="n">clnt</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="n">body</span><span class="o">=</span><span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>

<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">needle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'needle'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/addtotextindex/v1"</span>
<span class="c1">//FILE POST</span>
<span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"file"</span><span class="p">:</span> <span class="p">{</span> <span class="nl">file</span><span class="p">:</span> <span class="s1">'/home/user/testdata/sample.doc'</span><span class="p">,</span> <span class="na">content_type</span><span class="p">:</span> <span class="s1">'multipart/form-data'</span> <span class="p">},</span> <span class="s2">"index"</span><span class="err">:</span> <span class="s2">"myindex"</span><span class="p">,</span> <span class="s2">"apikey"</span><span class="err">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="nx">needle</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>

<pre><code class="highlight shell">curl -X POST -F <span class="s2">"file=/home/user/testdata/sample.doc"</span>-F <span class="s2">"index=myindex"</span> -F <span class="s2">"apikey=myapikey"</span>  https://api.idolondemand.com/1/api/sync/createtextindex/v1
</code></pre>

<h2 id="querying-a-text-index">Querying a Text Index</h2>

<p>After you populate your index, you can perform searches to get detailed information about your data. The <code class="prettyprint">Query Text Index</code> API allows you to perform text searches on your index.</p>

<blockquote>
<p>Querying an index</p>
</blockquote>

<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="s">"http://api.idolondemand.com/1/api/sync/querytextindex/v1"</span>
<span class="c">#GET</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"text"</span><span class="p">:</span> <span class="s">"mysearch"</span><span class="p">,</span> <span class="s">"indexes"</span><span class="p">:</span> <span class="s">"myindex"</span><span class="p">,</span>  <span class="s">"apikey"</span><span class="p">:</span><span class="s">"myapikey"</span> <span class="p">}</span>
<span class="n">bodyobj</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>

<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'httpclient'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="n">clnt</span> <span class="o">=</span> <span class="no">HTTPClient</span><span class="p">.</span><span class="nf">new</span>
<span class="n">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/querytextindex/v1"</span>
<span class="c1">#GET</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="ss">text: </span><span class="s2">"mysearch"</span><span class="p">,</span> <span class="ss">indexes: </span><span class="s2">"myindex"</span><span class="p">,</span>  <span class="n">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="n">resp</span><span class="o">=</span><span class="n">clnt</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="n">body</span><span class="o">=</span><span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>

<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">needle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'needle'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/querytextindex/v1"</span>
<span class="c1">//GET</span>
<span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"text"</span><span class="p">:</span> <span class="s2">"mysearch"</span><span class="p">,</span> <span class="s2">"indexes"</span><span class="p">:</span> <span class="s2">"myindex"</span><span class="p">,</span>  <span class="na">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="nx">needle</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="s1">'get'</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>

<pre><code class="highlight shell">curl -X POST -F <span class="s2">"text=mysearch"</span>-F <span class="s2">"indexes=myindex"</span> -F <span class="s2">"apikey=myapikey"</span>  https://api.idolondemand.com/1/api/sync/createtextindex/v1
</code></pre>

<h2 id="field-types">Field Types</h2>

<p>Data in the IDOL OnDemand text index is stored in fields. The fields can have different types depending on the content of the field, and what the field is used for. This page describes the main field types and their uses.</p>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Reference</td>
<td>The Reference fields contain a document reference that identifies the document. This might be a file path or URL, or some other identifying content. You can use this field to retrieve a specific document.</td>
</tr>
<tr>
<td>Index</td>
<td>Index fields contain the majority of the document content. When the data is indexed, index fields receive additional processing, such as stemming and stop word removal, to make it easier to search the data. Typically, index fields contain text that you query frequently, such as the title and main body of a document. You can also use Query Text field restrictions for Index fields. See Field Restrictions.</td>
</tr>
<tr>
<td>Parametric</td>
<td>Parametric fields contain content for parametric (faceted) search and filtering.  Typically, it contains a limited set of values to make it easier to filter content by a value. You can also use the MATCH FieldText operator for Parametric fields.  See FieldText Operators.</td>
</tr>
<tr>
<td>Numeric</td>
<td>Numeric fields contain a number.  This field type makes it faster to search for specific numeric values, and also enables searching for ranges, or values near a specified number, by using numeric FieldText operators.  See FieldText Operators.</td>
</tr>
<tr>
<td>Date</td>
<td>Date fields contain a date, in one of the configured date formats.  This field type makes it faster to search for dates, and enables searching for date ranges, or dates near a specified date, by using the date FieldText Operators.  See FieldText Operators.</td>
</tr>
<tr>
<td>Rank</td>
<td>Rank fields contain an internal document rank, which you can use to order search results.  Rank values are also used to bias the relevance sort order.</td>
</tr>
<tr>
<td>Store Only</td>
<td>Store Only fields contain any other type of data that does not have a special type.  These fields generally contain values that you do not need to search for specifically, but which might be useful information, such as the content length.</td>
</tr>
</tbody></table>

<h2 id="flavors">Flavors</h2>

<table><thead>
<tr>
<th>Flavor</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Querymanipulation</td>
<td>An query manipulation index is used to store promotions and other query promotions to be applied as part of a query profile.</td>
</tr>
<tr>
<td>Custom_Fields</td>
<td>A custom_field configuration that can accept up to 250,000 documents.</td>
</tr>
<tr>
<td>Explorer Flavor</td>
<td>An explorer configuration that can accept up to 25,000 documents.</td>
</tr>
<tr>
<td>Standard</td>
<td>A standard configuration that can accept up to 250,000 documents.</td>
</tr>
<tr>
<td>Categorization</td>
<td>An categorization index is used to categorise documents based on boolean restrictions and can be used to define up to 250,000 categories.</td>
</tr>
</tbody></table>

          <h1 id="web-cloud-connector">Web Cloud Connector</h1>

<p>Connectors are a very useful feature of IDOL OnDemand, allowing the ingestion of documents from various sources into IDOL Ondemand Text Indexes.</p>

<p>The Web Cloud Connector enables the indexing of a remote site, without the requirement to run a crawler, letting IDOL OnDemand do all the work.</p>

<h2 id="creating-the-connector">Creating the connector</h2>

<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="s">"http://api.idolondemand.com/1/api/sync/createconnector/v1"</span>
<span class="c">#POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"connector"</span><span class="p">:</span> <span class="s">"idolondemand"</span><span class="p">,</span> <span class="s">"flavor"</span><span class="p">:</span> <span class="s">"web_cloud"</span><span class="p">,</span> <span class="s">"config"</span><span class="p">:</span> <span class="s">"{ "</span><span class="n">url</span><span class="s">" : "</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">idolondemand</span><span class="o">.</span><span class="n">com</span><span class="s">" }"</span><span class="p">,</span> <span class="s">"destination"</span><span class="p">:</span> <span class="s">"{ "</span><span class="n">action</span><span class="s">" : "</span><span class="n">addtotextindex</span><span class="s">", "</span><span class="n">index</span><span class="s">" : "</span><span class="n">iodsite</span><span class="s">" }"</span><span class="p">,</span>  <span class="s">"apikey"</span><span class="p">:</span><span class="s">"myapikey"</span> <span class="p">}</span>
<span class="n">bodyobj</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>

<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'httpclient'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="n">clnt</span> <span class="o">=</span> <span class="no">HTTPClient</span><span class="p">.</span><span class="nf">new</span>
<span class="n">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/createconnector/v1"</span>
<span class="c1">#POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="ss">connector: </span><span class="s2">"idolondemand"</span><span class="p">,</span> <span class="ss">flavor: </span><span class="s2">"web_cloud"</span><span class="p">,</span> <span class="ss">config: </span><span class="s2">"{ "</span><span class="n">url</span><span class="s2">" : "</span><span class="n">http</span><span class="p">:</span><span class="sr">//</span><span class="n">www</span><span class="p">.</span><span class="nf">idolondemand</span><span class="p">.</span><span class="nf">com</span><span class="s2">" }"</span><span class="p">,</span> <span class="ss">destination: </span><span class="s2">"{ "</span><span class="n">action</span><span class="s2">" : "</span><span class="n">addtotextindex</span><span class="s2">", "</span><span class="n">index</span><span class="s2">" : "</span><span class="n">iodsite</span><span class="s2">" }"</span><span class="p">,</span>  <span class="n">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="n">resp</span><span class="o">=</span><span class="n">clnt</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="n">body</span><span class="o">=</span><span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>

<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">needle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'needle'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/createconnector/v1"</span>
<span class="c1">//POST</span>
<span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"connector"</span><span class="p">:</span> <span class="s2">"idolondemand"</span><span class="p">,</span> <span class="s2">"flavor"</span><span class="p">:</span> <span class="s2">"web_cloud"</span><span class="p">,</span> <span class="s2">"config"</span><span class="p">:</span> <span class="s2">"{ "</span><span class="nx">url</span><span class="s2">" : "</span><span class="na">http</span><span class="p">:</span><span class="c1">//www.idolondemand.com" }", "destination": "{ "action" : "addtotextindex", "index" : "iodsite" }",  apikey:"myapikey" }</span>
<span class="nx">needle</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>

<pre><code class="highlight shell">curl -X POST -F <span class="s2">"connector=idolondemand"</span>-F <span class="s2">"flavor=web_cloud"</span>-F <span class="s2">"config={ "</span>url<span class="s2">" : "</span>http://www.idolondemand.com<span class="s2">" }"</span>-F <span class="s2">"destination={ "</span>action<span class="s2">" : "</span>addtotextindex<span class="s2">", "</span>index<span class="s2">" : "</span>iodsite<span class="s2">" }"</span> -F <span class="s2">"apikey=myapikey"</span>  https://api.idolondemand.com/1/api/sync/createtextindex/v1
</code></pre>

<p>The first API we&rsquo;ll want to call is the <a href="https://www.idolondemand.com/developer/apis/createconnector">Create Connector API</a>. Calling it will create a connector of the type of our choice.</p>

<p>The required parameters are as follow:</p>

<ul>
<li><strong>connector</strong> : The name of our connector, which we&rsquo;ll use for further updating, status checking or deletion.</li>
<li><strong>flavor</strong> : This is where we want to specify which type of connector we want to use. In the case of the Web cloud connector the value will need to be <strong>web_cloud</strong></li>
<li><strong>config</strong> : This json parameter will contain configuration relevant to the type of connector we have selected.</li>
<li><strong>destination</strong> : This json parameter will specify what should be done with the output of the connector. Currently that would be which index we want to index into.</li>
</ul>

<p>The code on the right will create a Web Cloud connector to follow links from idolondemand.com and index every page it finds into the &ldquo;iodsite&rdquo; index.</p>

<h2 id="operating-the-connector">Operating the connector</h2>

<blockquote>
<p>Starting the connector</p>
</blockquote>

<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="s">"http://api.idolondemand.com/1/api/sync/startconnector/v1"</span>
<span class="c">#POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"connector"</span><span class="p">:</span> <span class="s">"idolondemand"</span><span class="p">,</span>  <span class="s">"apikey"</span><span class="p">:</span><span class="s">"myapikey"</span> <span class="p">}</span>
<span class="n">bodyobj</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>

<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'httpclient'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="n">clnt</span> <span class="o">=</span> <span class="no">HTTPClient</span><span class="p">.</span><span class="nf">new</span>
<span class="n">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/startconnector/v1"</span>
<span class="c1">#POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="ss">connector: </span><span class="s2">"idolondemand"</span><span class="p">,</span>  <span class="n">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="n">resp</span><span class="o">=</span><span class="n">clnt</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="n">body</span><span class="o">=</span><span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>

<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">needle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'needle'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/startconnector/v1"</span>
<span class="c1">//POST</span>
<span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"connector"</span><span class="p">:</span> <span class="s2">"idolondemand"</span><span class="p">,</span>  <span class="na">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="nx">needle</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>

<pre><code class="highlight shell">curl -X POST -F <span class="s2">"connector=idolondemand"</span> -F <span class="s2">"apikey=myapikey"</span>  https://api.idolondemand.com/1/api/sync/createtextindex/v1
</code></pre>

<p>The <a href="https://www.idolondemand.com/developer/apis/startconnector">Start Connector API</a> takes a connector name and will start a craw.</p>

<p>Identically the <a href="https://www.idolondemand.com/developer/apis/stopconnector">Stop Connector API</a> can stop a run.</p>

<blockquote>
<p>Checking the status of the connector</p>
</blockquote>

<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="s">"http://api.idolondemand.com/1/api/sync/connectorstatus/v1"</span>
<span class="c">#POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"connector"</span><span class="p">:</span> <span class="s">"idolondemand"</span><span class="p">,</span>  <span class="s">"apikey"</span><span class="p">:</span><span class="s">"myapikey"</span> <span class="p">}</span>
<span class="n">bodyobj</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>

<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'httpclient'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="n">clnt</span> <span class="o">=</span> <span class="no">HTTPClient</span><span class="p">.</span><span class="nf">new</span>
<span class="n">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/connectorstatus/v1"</span>
<span class="c1">#POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="ss">connector: </span><span class="s2">"idolondemand"</span><span class="p">,</span>  <span class="n">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="n">resp</span><span class="o">=</span><span class="n">clnt</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="n">body</span><span class="o">=</span><span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>

<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">needle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'needle'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/connectorstatus/v1"</span>
<span class="c1">//POST</span>
<span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"connector"</span><span class="p">:</span> <span class="s2">"idolondemand"</span><span class="p">,</span>  <span class="na">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="nx">needle</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>

<pre><code class="highlight shell">curl -X POST -F <span class="s2">"connector=idolondemand"</span> -F <span class="s2">"apikey=myapikey"</span>  https://api.idolondemand.com/1/api/sync/createtextindex/v1
</code></pre>

<p>We can check whether a connector is running using the connectorstatus api.</p>

<blockquote>
<p>Sample output of the connector status api</p>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"connector"</span><span class="p">:</span><span class="w"> </span><span class="s2">"idolondemand"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PROCESSING"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MTI3LjAuMS4xOjcyMDA6RkVUQ0g6LTEzMjcwNTE0NTU="</span><span class="p">,</span><span class="w">
  </span><span class="s2">"queued_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"24/04/2015 17:11:05 +00:00"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"time_in_queue"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"process_start_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"24/04/2015 17:11:05 +00:00"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"time_processing"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"document_counts"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><strong>Starting from scratch</strong></p>

<blockquote>
<p>Ignoring previous runs</p>
</blockquote>

<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="s">"http://api.idolondemand.com/1/api/sync/startconnector/v1"</span>
<span class="c">#POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"connector"</span><span class="p">:</span> <span class="s">"idolondemand"</span><span class="p">,</span> <span class="s">"ignore_previous_state"</span><span class="p">:</span> <span class="s">"True"</span><span class="p">,</span>  <span class="s">"apikey"</span><span class="p">:</span><span class="s">"myapikey"</span> <span class="p">}</span>
<span class="n">bodyobj</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>

<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'httpclient'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="n">clnt</span> <span class="o">=</span> <span class="no">HTTPClient</span><span class="p">.</span><span class="nf">new</span>
<span class="n">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/startconnector/v1"</span>
<span class="c1">#POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="ss">connector: </span><span class="s2">"idolondemand"</span><span class="p">,</span> <span class="ss">ignore_previous_state: </span><span class="s2">"True"</span><span class="p">,</span>  <span class="n">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="n">resp</span><span class="o">=</span><span class="n">clnt</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="n">body</span><span class="o">=</span><span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>

<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">needle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'needle'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/startconnector/v1"</span>
<span class="c1">//POST</span>
<span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"connector"</span><span class="p">:</span> <span class="s2">"idolondemand"</span><span class="p">,</span> <span class="s2">"ignore_previous_state"</span><span class="p">:</span> <span class="s2">"True"</span><span class="p">,</span>  <span class="na">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="nx">needle</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>

<pre><code class="highlight shell">curl -X POST -F <span class="s2">"connector=idolondemand"</span>-F <span class="s2">"ignore_previous_state=True"</span> -F <span class="s2">"apikey=myapikey"</span>  https://api.idolondemand.com/1/api/sync/createtextindex/v1
</code></pre>

<p>Using the <code class="prettyprint">ignore_previous_state</code> parameter, the connector will only crawl and index new/modified pages by default, however the <code class="prettyprint">ignore_previous_state</code> parameter will force the connector to ignore previous runs and act like it would on a first run.</p>

<h2 id="configuring">Configuring</h2>

<blockquote>
<p><strong>Setting limits</strong></p>
</blockquote>
<pre><code class="highlight json"><span class="s2">"max_pages"</span><span class="err">:</span><span class="w"> </span><span class="mi">40</span><span class="w">
</span><span class="s2">"duration"</span><span class="err">:</span><span class="w"> </span><span class="mi">300</span><span class="err">,</span><span class="w">
</span><span class="s2">"depth"</span><span class="err">:</span><span class="mi">3</span><span class="w">
</span></code></pre>

<blockquote>
<p><strong>Controlling which pages are indexed</strong></p>
</blockquote>
<pre><code class="highlight json"><span class="s2">"url_cant_have_regex"</span><span class="err">:</span><span class="w"> </span><span class="s2">".*\\.php$"</span><span class="err">,</span><span class="w">
</span><span class="s2">"url_must_have_regex"</span><span class="err">:</span><span class="w"> </span><span class="s2">".*\\.html$"</span><span class="err">,</span><span class="w">
</span></code></pre>

<blockquote>
<p>The <code class="prettyprint">url_cant_have_regex</code> and <code class="prettyprint">url_must_have_regex</code> allow you to specify regexes for which pages to index and which pages not to index.</p>
</blockquote>
<pre><code class="highlight json"><span class="s2">"max_links_per_page"</span><span class="err">:</span><span class="w"> </span><span class="mi">1000</span><span class="err">,</span><span class="w">
</span></code></pre>

<blockquote>
<p><code class="prettyprint">max_links_per_page</code> lets us choose not to index pages with too many links, avoiding Table of Contents or Sitemaps for example.</p>
</blockquote>
<pre><code class="highlight json"><span class="s2">"min_page_size"</span><span class="err">:</span><span class="w"> </span><span class="mi">4096</span><span class="err">,</span><span class="w">
</span><span class="s2">"max_page_size"</span><span class="err">:</span><span class="w"> </span><span class="mi">30000000</span><span class="err">,</span><span class="w">
</span></code></pre>

<blockquote>
<p><code class="prettyprint">min_page_size</code> and <code class="prettyprint">max_page_size</code> lets us set in bytes restictions on the sizes of the pages to index.</p>
</blockquote>

<p>In our previous connector creation we just pointed the connector to the idolondemand.com page, there are however a few things we may want to add to our configuration.</p>

<h2 id="updating">Updating</h2>

<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="s">"http://api.idolondemand.com/1/api/sync/retrieveconfig/v1"</span>
<span class="c">#POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"connector"</span><span class="p">:</span> <span class="s">"idolondemand"</span><span class="p">,</span>  <span class="s">"apikey"</span><span class="p">:</span><span class="s">"myapikey"</span> <span class="p">}</span>
<span class="n">bodyobj</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>

<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'httpclient'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="n">clnt</span> <span class="o">=</span> <span class="no">HTTPClient</span><span class="p">.</span><span class="nf">new</span>
<span class="n">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/retrieveconfig/v1"</span>
<span class="c1">#POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="ss">connector: </span><span class="s2">"idolondemand"</span><span class="p">,</span>  <span class="n">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="n">resp</span><span class="o">=</span><span class="n">clnt</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="n">body</span><span class="o">=</span><span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>

<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">needle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'needle'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/retrieveconfig/v1"</span>
<span class="c1">//POST</span>
<span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"connector"</span><span class="p">:</span> <span class="s2">"idolondemand"</span><span class="p">,</span>  <span class="na">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="nx">needle</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>

<pre><code class="highlight shell">curl -X POST -F <span class="s2">"connector=idolondemand"</span> -F <span class="s2">"apikey=myapikey"</span>  https://api.idolondemand.com/1/api/sync/createtextindex/v1
</code></pre>

<blockquote>
<p>Updating the configuration</p>
</blockquote>

<p><pre><code class="highlight python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="s">&quot;http://api.idolondemand.com/1/api/sync/updateconnector/v1&quot;</span>
<span class="c">#POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;connector&quot;</span><span class="p">:</span> <span class="s">&quot;idolondemand&quot;</span><span class="p">,</span> <span class="s">&quot;config&quot;</span><span class="p">:</span> <span class="s">&quot;&lt;newconfig&gt;&quot;</span><span class="p">,</span>  <span class="s">&quot;apikey&quot;</span><span class="p">:</span><span class="s">&quot;myapikey&quot;</span> <span class="p">}</span>
<span class="n">bodyobj</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">&#39;httpclient&#39;</span>
<span class="nb">require</span> <span class="s1">&#39;json&#39;</span>
<span class="n">clnt</span> <span class="o">=</span> <span class="no">HTTPClient</span><span class="p">.</span><span class="nf">new</span>
<span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://api.idolondemand.com/1/api/sync/updateconnector/v1&quot;</span>
<span class="c1">#POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="ss">connector: </span><span class="s2">&quot;idolondemand&quot;</span><span class="p">,</span> <span class="ss">config: </span><span class="s2">&quot;&lt;newconfig&gt;&quot;</span><span class="p">,</span>  <span class="n">apikey</span><span class="p">:</span><span class="s2">&quot;myapikey&quot;</span> <span class="p">}</span>
<span class="n">resp</span><span class="o">=</span><span class="n">clnt</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="n">body</span><span class="o">=</span><span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>
<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">needle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;needle&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span><span class="o">=</span><span class="s2">&quot;http://api.idolondemand.com/1/api/sync/updateconnector/v1&quot;</span>
<span class="c1">//POST</span>
<span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;connector&quot;</span><span class="p">:</span> <span class="s2">&quot;idolondemand&quot;</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;newconfig&gt;&quot;</span><span class="p">,</span>  <span class="na">apikey</span><span class="p">:</span><span class="s2">&quot;myapikey&quot;</span> <span class="p">}</span>
<span class="nx">needle</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>
<pre><code class="highlight shell">curl -X POST -F <span class="s2">&quot;connector=idolondemand&quot;</span>-F <span class="s2">&quot;config=&lt;newconfig&gt;&quot;</span> -F <span class="s2">&quot;apikey=myapikey&quot;</span>  https://api.idolondemand.com/1/api/sync/createtextindex/v1
</code></pre></p>

<blockquote>
<p>Updating the destination or the scheduling</p>
</blockquote>

<p><pre><code class="highlight python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="s">&quot;http://api.idolondemand.com/1/api/sync/startconnector/v1&quot;</span>
<span class="c">#POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;connector&quot;</span><span class="p">:</span> <span class="s">&quot;idolondemand&quot;</span><span class="p">,</span> <span class="s">&quot;schedule&quot;</span><span class="p">:</span> <span class="s">&quot;&lt;newschedule&gt;&quot;</span><span class="p">,</span> <span class="s">&quot;destination&quot;</span><span class="p">:</span> <span class="s">&quot;&lt;newdestination&gt;&quot;</span><span class="p">,</span>  <span class="s">&quot;apikey&quot;</span><span class="p">:</span><span class="s">&quot;myapikey&quot;</span> <span class="p">}</span>
<span class="n">bodyobj</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">&#39;httpclient&#39;</span>
<span class="nb">require</span> <span class="s1">&#39;json&#39;</span>
<span class="n">clnt</span> <span class="o">=</span> <span class="no">HTTPClient</span><span class="p">.</span><span class="nf">new</span>
<span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://api.idolondemand.com/1/api/sync/startconnector/v1&quot;</span>
<span class="c1">#POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="ss">connector: </span><span class="s2">&quot;idolondemand&quot;</span><span class="p">,</span> <span class="ss">schedule: </span><span class="s2">&quot;&lt;newschedule&gt;&quot;</span><span class="p">,</span> <span class="ss">destination: </span><span class="s2">&quot;&lt;newdestination&gt;&quot;</span><span class="p">,</span>  <span class="n">apikey</span><span class="p">:</span><span class="s2">&quot;myapikey&quot;</span> <span class="p">}</span>
<span class="n">resp</span><span class="o">=</span><span class="n">clnt</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="n">body</span><span class="o">=</span><span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>
<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">needle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;needle&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span><span class="o">=</span><span class="s2">&quot;http://api.idolondemand.com/1/api/sync/startconnector/v1&quot;</span>
<span class="c1">//POST</span>
<span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;connector&quot;</span><span class="p">:</span> <span class="s2">&quot;idolondemand&quot;</span><span class="p">,</span> <span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;newschedule&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;destination&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;newdestination&gt;&quot;</span><span class="p">,</span>  <span class="na">apikey</span><span class="p">:</span><span class="s2">&quot;myapikey&quot;</span> <span class="p">}</span>
<span class="nx">needle</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>
<pre><code class="highlight shell">curl -X POST -F <span class="s2">&quot;connector=idolondemand&quot;</span>-F <span class="s2">&quot;schedule=&lt;newschedule&gt;&quot;</span>-F <span class="s2">&quot;destination=&lt;newdestination&gt;&quot;</span> -F <span class="s2">&quot;apikey=myapikey&quot;</span>  https://api.idolondemand.com/1/api/sync/createtextindex/v1
</code></pre></p>

<p>Once we have created a connector, we may want to change the configuration.</p>

<p>The <a href="https://www.idolondemand.com/developer/apis/retrieveconfig">Retrieve Config API</a> takes a connector name and will return its config.</p>

<p>Once we have checked the config we can decide to change it.</p>

<p>The <a href="https://www.idolondemand.com/developer/apis/updateconnector">Update Connector API</a> lets us take an existing connector and change its configuration.</p>

          <h1 id="promoting-search-results">Promoting search results</h1>

<p>When building your search functionality, sometimes you want to ensure certain results are always returned when searching for some terms.
This is something we call &ldquo;Promotions&rdquo;.</p>

<h2 id="create-a-query-profile-index">Create a Query Profile Index</h2>

<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="s">"http://api.idolondemand.com/1/api/sync/createtextindex/v1"</span>
<span class="c">#GET</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"index"</span><span class="p">:</span> <span class="s">"sports"</span><span class="p">,</span> <span class="s">"flavor"</span><span class="p">:</span> <span class="s">"querymanipulation"</span><span class="p">,</span>  <span class="s">"apikey"</span><span class="p">:</span><span class="s">"myapikey"</span> <span class="p">}</span>
<span class="n">bodyobj</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>

<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'httpclient'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="n">clnt</span> <span class="o">=</span> <span class="no">HTTPClient</span><span class="p">.</span><span class="nf">new</span>
<span class="n">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/createtextindex/v1"</span>
<span class="c1">#GET</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="ss">index: </span><span class="s2">"sports"</span><span class="p">,</span> <span class="ss">flavor: </span><span class="s2">"querymanipulation"</span><span class="p">,</span>  <span class="n">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="n">resp</span><span class="o">=</span><span class="n">clnt</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="n">body</span><span class="o">=</span><span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>

<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">needle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'needle'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/createtextindex/v1"</span>
<span class="c1">//GET</span>
<span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"index"</span><span class="p">:</span> <span class="s2">"sports"</span><span class="p">,</span> <span class="s2">"flavor"</span><span class="p">:</span> <span class="s2">"querymanipulation"</span><span class="p">,</span>  <span class="na">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="nx">needle</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="s1">'get'</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>

<pre><code class="highlight shell">curl -X POST -F <span class="s2">"index=sports"</span>-F <span class="s2">"flavor=querymanipulation"</span> -F <span class="s2">"apikey=myapikey"</span>  https://api.idolondemand.com/1/api/sync/createtextindex/v1
</code></pre>

<p>The first thing you&rsquo;ll want to do is to create a Text Index with the flavor querymanipulation. That text index is where we&rsquo;ll be able to configure which documents should show up when.
Here we&rsquo;ll want to manipulate searches about sports.</p>

<h2 id="add-promotion-documents-to-the-index">Add promotion documents to the index</h2>

<p>Now that we have our querymanipulation index we can create documents that will be returned when we search for something.</p>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
            </span><span class="s2">"document"</span><span class="p">:[{</span><span class="w">
                           </span><span class="s2">"reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"beckham"</span><span class="p">,</span><span class="w">
                           </span><span class="s2">"category"</span><span class="p">:</span><span class="s2">"people"</span><span class="p">,</span><span class="w">
                           </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"Promotion"</span><span class="p">,</span><span class="w">
                           </span><span class="s2">"content"</span><span class="p">:</span><span class="s2">"football"</span><span class="p">,</span><span class="w">
                           </span><span class="s2">"STATIC_REFERENCE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://en.wikipedia.org/wiki/David Beckham"</span><span class="p">,</span><span class="w">
                           </span><span class="s2">"STATIC_TITLE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My Beck Promotion"</span><span class="p">,</span><span class="w">
                           </span><span class="s2">"STATIC_CONTENT"</span><span class="p">:</span><span class="s2">"This is my Beck promotion"</span><span class="w">
            </span><span class="p">}]</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre>

<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="s">"http://api.idolondemand.com/1/api/sync/addtotextindex/v1"</span>
<span class="c">#POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"json"</span><span class="p">:</span> <span class="s">" { "</span><span class="n">document</span><span class="s">":[{ "</span><span class="n">reference</span><span class="s">": "</span><span class="n">beckham</span><span class="s">", "</span><span class="n">category</span><span class="s">":"</span><span class="n">people</span><span class="s">", "</span><span class="nb">type</span><span class="s">":"</span><span class="n">Promotion</span><span class="s">", "</span><span class="n">content</span><span class="s">":"</span><span class="n">football</span><span class="s">", "</span><span class="n">STATIC_REFERENCE</span><span class="s">": "</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">en</span><span class="o">.</span><span class="n">wikipedia</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">wiki</span><span class="o">/</span><span class="n">David</span> <span class="n">Beckham</span><span class="s">", "</span><span class="n">STATIC_TITLE</span><span class="s">": "</span><span class="n">My</span> <span class="n">Beck</span> <span class="n">Promotion</span><span class="s">", "</span><span class="n">STATIC_CONTENT</span><span class="s">":"</span><span class="n">This</span> <span class="ow">is</span> <span class="n">my</span> <span class="n">Beck</span> <span class="n">promotion</span><span class="s">" }] } "</span><span class="p">,</span> <span class="s">"index"</span><span class="p">:</span> <span class="s">"sports"</span><span class="p">,</span>  <span class="s">"apikey"</span><span class="p">:</span><span class="s">"myapikey"</span> <span class="p">}</span>
<span class="n">bodyobj</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>

<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'httpclient'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="n">clnt</span> <span class="o">=</span> <span class="no">HTTPClient</span><span class="p">.</span><span class="nf">new</span>
<span class="n">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/addtotextindex/v1"</span>
<span class="c1">#POST</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="ss">json: </span><span class="s2">" { "</span><span class="n">document</span><span class="s2">":[{ "</span><span class="n">reference</span><span class="s2">": "</span><span class="n">beckham</span><span class="s2">", "</span><span class="n">category</span><span class="s2">":"</span><span class="n">people</span><span class="s2">", "</span><span class="n">type</span><span class="s2">":"</span><span class="no">Promotion</span><span class="s2">", "</span><span class="n">content</span><span class="s2">":"</span><span class="n">football</span><span class="s2">", "</span><span class="no">STATIC_REFERENCE</span><span class="s2">": "</span><span class="n">http</span><span class="p">:</span><span class="sr">//en</span><span class="p">.</span><span class="nf">wikipedia</span><span class="p">.</span><span class="nf">org</span><span class="sr">/wiki/</span><span class="no">David</span> <span class="no">Beckham</span><span class="s2">", "</span><span class="no">STATIC_TITLE</span><span class="s2">": "</span><span class="no">My</span> <span class="no">Beck</span> <span class="no">Promotion</span><span class="s2">", "</span><span class="no">STATIC_CONTENT</span><span class="s2">":"</span><span class="no">This</span> <span class="n">is</span> <span class="n">my</span> <span class="no">Beck</span> <span class="n">promotion</span><span class="s2">" }] } "</span><span class="p">,</span> <span class="ss">index: </span><span class="s2">"sports"</span><span class="p">,</span>  <span class="n">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="n">resp</span><span class="o">=</span><span class="n">clnt</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="n">body</span><span class="o">=</span><span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>

<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">needle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'needle'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/addtotextindex/v1"</span>
<span class="c1">//POST</span>
<span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"json"</span><span class="p">:</span> <span class="s2">" { "</span><span class="nb">document</span><span class="s2">":[{ "</span><span class="nx">reference</span><span class="s2">": "</span><span class="nx">beckham</span><span class="s2">", "</span><span class="nx">category</span><span class="s2">":"</span><span class="nx">people</span><span class="s2">", "</span><span class="nx">type</span><span class="s2">":"</span><span class="nx">Promotion</span><span class="s2">", "</span><span class="nx">content</span><span class="s2">":"</span><span class="nx">football</span><span class="s2">", "</span><span class="nx">STATIC_REFERENCE</span><span class="s2">": "</span><span class="na">http</span><span class="p">:</span><span class="c1">//en.wikipedia.org/wiki/David Beckham", "STATIC_TITLE": "My Beck Promotion", "STATIC_CONTENT":"This is my Beck promotion" }] } ", "index": "sports",  apikey:"myapikey" }</span>
<span class="nx">needle</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>

<pre><code class="highlight shell">curl -X POST -F <span class="s2">"json= { "</span>document<span class="s2">":[{ "</span>reference<span class="s2">": "</span>beckham<span class="s2">", "</span>category<span class="s2">":"</span>people<span class="s2">", "</span><span class="nb">type</span><span class="s2">":"</span>Promotion<span class="s2">", "</span>content<span class="s2">":"</span>football<span class="s2">", "</span>STATIC_REFERENCE<span class="s2">": "</span>http://en.wikipedia.org/wiki/David Beckham<span class="s2">", "</span>STATIC_TITLE<span class="s2">": "</span>My Beck Promotion<span class="s2">", "</span>STATIC_CONTENT<span class="s2">":"</span>This is my Beck promotion<span class="s2">" }] } "</span>-F <span class="s2">"index=sports"</span> -F <span class="s2">"apikey=myapikey"</span>  https://api.idolondemand.com/1/api/sync/createtextindex/v1
</code></pre>

<p>Adding documents to this index is the same as adding documents to any index, it will expect json documents with a reference field, title and content fields.
The difference here is that the content field should contain the terms that when searched for will always return the document we want to promote. THat promoted document is defined using fields named STATIC_FIELDNAME, such as STATIC_REFERENCE or STATIC_TITLE.</p>

<h2 id="creating-our-query-profile">Creating our query profile</h2>

<p>Now that we&rsquo;ve created our querymanipulation index, we can create a Query Profile associated to it, we will then call that Query Profile when doing our Query Text Index query.</p>
<pre><code class="highlight json"><span class="w">
   </span><span class="p">{</span><span class="w">
      </span><span class="s2">"querymanipulationindex"</span><span class="p">:</span><span class="s2">"sports"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"promotions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
               </span><span class="s2">"enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">,</span><span class="w">
               </span><span class="s2">"every_page"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">,</span><span class="w">
               </span><span class="s2">"identified"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">,</span><span class="w">
               </span><span class="s2">"categories"</span><span class="p">:[</span><span class="s2">"people"</span><span class="p">]}</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span></code></pre>

<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="s">"http://api.idolondemand.com/1/api/sync/createqueryprofile/v1"</span>
<span class="c">#GET</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"query_profile"</span><span class="p">:</span> <span class="s">"sports_profile"</span><span class="p">,</span> <span class="s">"json"</span><span class="p">:</span> <span class="s">" { "</span><span class="n">querymanipulationindex</span><span class="s">":"</span><span class="n">sports</span><span class="s">", "</span><span class="n">promotions</span><span class="s">": { "</span><span class="n">enabled</span><span class="s">": true , "</span><span class="n">every_page</span><span class="s">": true , "</span><span class="n">identified</span><span class="s">": true , "</span><span class="n">categories</span><span class="s">":["</span><span class="n">people</span><span class="s">"]} }"</span><span class="p">,</span>  <span class="s">"apikey"</span><span class="p">:</span><span class="s">"myapikey"</span> <span class="p">}</span>
<span class="n">bodyobj</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>

<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'httpclient'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="n">clnt</span> <span class="o">=</span> <span class="no">HTTPClient</span><span class="p">.</span><span class="nf">new</span>
<span class="n">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/createqueryprofile/v1"</span>
<span class="c1">#GET</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="ss">query_profile: </span><span class="s2">"sports_profile"</span><span class="p">,</span> <span class="ss">json: </span><span class="s2">" { "</span><span class="n">querymanipulationindex</span><span class="s2">":"</span><span class="n">sports</span><span class="s2">", "</span><span class="n">promotions</span><span class="s2">": { "</span><span class="n">enabled</span><span class="s2">": true , "</span><span class="n">every_page</span><span class="s2">": true , "</span><span class="n">identified</span><span class="s2">": true , "</span><span class="n">categories</span><span class="s2">":["</span><span class="n">people</span><span class="s2">"]} }"</span><span class="p">,</span>  <span class="n">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="n">resp</span><span class="o">=</span><span class="n">clnt</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="n">body</span><span class="o">=</span><span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>

<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">needle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'needle'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span><span class="o">=</span><span class="s2">"http://api.idolondemand.com/1/api/sync/createqueryprofile/v1"</span>
<span class="c1">//GET</span>
<span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"query_profile"</span><span class="p">:</span> <span class="s2">"sports_profile"</span><span class="p">,</span> <span class="s2">"json"</span><span class="p">:</span> <span class="s2">" { "</span><span class="nx">querymanipulationindex</span><span class="s2">":"</span><span class="nx">sports</span><span class="s2">", "</span><span class="nx">promotions</span><span class="s2">": { "</span><span class="nx">enabled</span><span class="s2">": true , "</span><span class="nx">every_page</span><span class="s2">": true , "</span><span class="nx">identified</span><span class="s2">": true , "</span><span class="nx">categories</span><span class="s2">":["</span><span class="nx">people</span><span class="s2">"]} }"</span><span class="p">,</span>  <span class="na">apikey</span><span class="p">:</span><span class="s2">"myapikey"</span> <span class="p">}</span>
<span class="nx">needle</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="s1">'get'</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>

<pre><code class="highlight shell">curl -X POST -F <span class="s2">"query_profile=sports_profile"</span>-F <span class="s2">"json= { "</span>querymanipulationindex<span class="s2">":"</span>sports<span class="s2">", "</span>promotions<span class="s2">": { "</span>enabled<span class="s2">": true , "</span>every_page<span class="s2">": true , "</span>identified<span class="s2">": true , "</span>categories<span class="s2">":["</span>people<span class="s2">"]} }"</span> -F <span class="s2">"apikey=myapikey"</span>  https://api.idolondemand.com/1/api/sync/createtextindex/v1
</code></pre>

<p>## Applying our query profile to a search</p>

<p>Whenever we do a search now for the word &ldquo;football&rdquo; and specify our sports_profile query profile, our promoted result will appear.</p>

<p><pre><code class="highlight python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span><span class="o">=</span><span class="s">&quot;http://api.idolondemand.com/1/api/sync/querytextindex/v1&quot;</span>
<span class="c">#GET</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;text&quot;</span><span class="p">:</span> <span class="s">&quot;football&quot;</span><span class="p">,</span> <span class="s">&quot;indexes&quot;</span><span class="p">:</span> <span class="s">&quot;wiki_eng&quot;</span><span class="p">,</span> <span class="s">&quot;query_profile&quot;</span><span class="p">:</span> <span class="s">&quot;sports_profile&quot;</span><span class="p">,</span>  <span class="s">&quot;apikey&quot;</span><span class="p">:</span><span class="s">&quot;myapikey&quot;</span> <span class="p">}</span>
<span class="n">bodyobj</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">&#39;httpclient&#39;</span>
<span class="nb">require</span> <span class="s1">&#39;json&#39;</span>
<span class="n">clnt</span> <span class="o">=</span> <span class="no">HTTPClient</span><span class="p">.</span><span class="nf">new</span>
<span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://api.idolondemand.com/1/api/sync/querytextindex/v1&quot;</span>
<span class="c1">#GET</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="ss">text: </span><span class="s2">&quot;football&quot;</span><span class="p">,</span> <span class="ss">indexes: </span><span class="s2">&quot;wiki_eng&quot;</span><span class="p">,</span> <span class="ss">query_profile: </span><span class="s2">&quot;sports_profile&quot;</span><span class="p">,</span>  <span class="n">apikey</span><span class="p">:</span><span class="s2">&quot;myapikey&quot;</span> <span class="p">}</span>
<span class="n">resp</span><span class="o">=</span><span class="n">clnt</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
<span class="n">body</span><span class="o">=</span><span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
</code></pre>
<pre><code class="highlight javascript"><span class="kd">var</span> <span class="nx">needle</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;needle&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span><span class="o">=</span><span class="s2">&quot;http://api.idolondemand.com/1/api/sync/querytextindex/v1&quot;</span>
<span class="c1">//GET</span>
<span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;football&quot;</span><span class="p">,</span> <span class="s2">&quot;indexes&quot;</span><span class="p">:</span> <span class="s2">&quot;wiki_eng&quot;</span><span class="p">,</span> <span class="s2">&quot;query_profile&quot;</span><span class="p">:</span> <span class="s2">&quot;sports_profile&quot;</span><span class="p">,</span>  <span class="na">apikey</span><span class="p">:</span><span class="s2">&quot;myapikey&quot;</span> <span class="p">}</span>
<span class="nx">needle</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="s1">&#39;get&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>
<pre><code class="highlight shell">curl -X POST -F <span class="s2">&quot;text=football&quot;</span>-F <span class="s2">&quot;indexes=wiki_eng&quot;</span>-F <span class="s2">&quot;query_profile=sports_profile&quot;</span> -F <span class="s2">&quot;apikey=myapikey&quot;</span>  https://api.idolondemand.com/1/api/sync/createtextindex/v1
</code></pre></p>

<p>&ldquo;`json
    {
  &quot;documents&rdquo;: [
    {
      &ldquo;reference&rdquo;: &ldquo;http://en.wikipedia.org/wiki/David Beckham&rdquo;,
      &ldquo;index&rdquo;: &ldquo;sports&rdquo;,
      &ldquo;title&rdquo;: &ldquo;My Beck Promotion&rdquo;,
      &ldquo;promotion&rdquo;: true,
      &ldquo;content&rdquo;: &ldquo;This is my Beck promotion&rdquo;
    },
    {
      &ldquo;reference&rdquo;: &ldquo;http://en.wikipedia.org/wiki/Association football&rdquo;,
      &ldquo;weight&rdquo;: 90.99,</p>

<p>&ldquo;`</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="ruby">ruby</a>
                <a href="#" data-language-name="python">python</a>
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
